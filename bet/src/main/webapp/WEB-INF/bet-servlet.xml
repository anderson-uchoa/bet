<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
"http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
	
	<!-- Exposicao da interface do servidor para invocacao remota -->
	<bean name="TratarCartao" class="org.springframework.remoting.httpinvoker.HttpInvokerServiceExporter">
	  <property name="service">
		<ref bean="ControlValidadorServidor"/>
	  </property>
	  <property name="serviceInterface">
		<value>lps.bet.basico.controlValidadorServidor.IProcessarTransacao</value>
	  </property>
	</bean>
	
	<!-- Configuracao do acesso web -->
	<bean id="velocityConfigurer" class="org.springframework.web.servlet.view.velocity.VelocityConfigurer">
		<property name="resourceLoaderPath">
			<value>/WEB-INF/html/</value>
		</property>  
	</bean>
	
	<bean class="org.springframework.web.servlet.view.velocity.VelocityViewResolver">
		<property name="prefix">
			<value></value>
		</property> 
		<property name="suffix">
			<value>.vm</value>
		</property> 
	</bean>

	<bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
		<property name="mappings">
			<props>
				<prop key="/controlGerencia.html">ControlGerencia</prop>
				<prop key="/gerenciaFuncionario.html">GerenciaFuncionario</prop>
				<prop key="/gerenciaCargo.html">GerenciaCargo</prop>
				<prop key="/gerenciaLinha.html">GerenciaLinha</prop>
				<prop key="/gerenciaOnibus.html">GerenciaOnibus</prop>
				<prop key="/gerenciaCorrida.html">GerenciaCorrida</prop>
				<prop key="/gerenciaTarifa.html">GerenciaTarifa</prop>
				<prop key="/gerenciaEmprViaria.html">GerenciaEmpresaViaria</prop>
				<prop key="/gerenciaSistViarioUrbano.html">GerenciaSistViarioUrbano</prop>
				<prop key="/gerenciaPassageiro.html">GerenciaPassageiro</prop>
				<prop key="/gerenciaTipoPassageiro.html">GerenciaTipoPassageiro</prop>
				<prop key="/gerenciaCartao.html">GerenciaCartao</prop>
				<prop key="/gerenciaPagamento.html">GerenciaPagamento</prop>
				<prop key="/gerenciaViagem.html">GerenciaViagem</prop>
				
				<prop key="/aquisicaoCartao.html">AquisicaoCartao</prop>		
				<prop key="/cargaCartao.html">CargaCartao</prop>
				
				<prop key="/acessoBasico.html">AcessoBasico</prop>
				<prop key="/login.html">GerenciaLogin</prop>
				<prop key="/logout.html">GerenciaLogin</prop>
				
				<prop key="/formTarifa.html">GerenciaTarifa</prop>
				<prop key="/formPassageiro.html">GerenciaPassageiro</prop>
				<prop key="/formTipoPassageiro.html">GerenciaTipoPassageiro</prop>
				<prop key="/formCartao.html">GerenciaCartao</prop>
				<prop key="/formViagem.html">GerenciaViagem</prop>
				<prop key="/formPagamento.html">GerenciaPagamento</prop>
				<prop key="/formLinha.html">GerenciaLinha</prop>
				<prop key="/formCorrida.html">GerenciaCorrida</prop>
				<prop key="/formCargo.html">GerenciaCargo</prop>
				<prop key="/formFuncionario.html">GerenciaFuncionario</prop>
				
				<prop key="/tratarCartao.html">TratarCartao</prop>
			</props>
		</property>
	</bean>	
	
	<!--Parte do Acesso WEB-->
	<bean id="ControlGerencia" class="lps.bet.basico.web.controlGerencia.ControlGerencia"/>

	<!--bean id="ControladorBET" class="lps.bet.basico.web.ControladorBet">
		<property name="nivelMinimoAcesso">
			<value>${config.nivel.ControladorBET}</value>
		</property>
	</bean-->
	
	<bean id="CargaCartao" class="lps.bet.basico.web.cargaCartao.CargaCartao">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="nivelMinimoAcesso">
			<value>${config.nivel.CargaCartao}</value>
		</property>
	</bean>
	
	<bean id="AcessoBasico" class="lps.bet.basico.web.acessoBasico.AcessoBasico">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfacePassageiroMgt">
			<ref bean="PassageiroMgr"/>
		</property> 
		<property name="nivelMinimoAcesso">
			<value>${config.nivel.AcessoBasico}</value>
		</property>
	</bean>

	<bean id="GerenciaLogin" class="lps.bet.basico.web.acessoBasico.GerenciaLogin">
		<property name="interfaceAutenticacao">
			<ref bean="AutenticacaoDAO"/>
		</property>		
	</bean>
	
	<bean id="AquisicaoCartao" class="lps.bet.basico.web.aquisicaoCartao.AquisicaoCartao">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfacePassageiroMgt">
			<ref bean="PassageiroMgr"/>
		</property> 
	</bean>
	
	<bean id="GerenciaTarifa" class="lps.bet.basico.web.controlGerencia.viacao.GerenciaTarifa">
		<property name="interfaceViacaoMgt">
			<ref bean="ViacaoMgr"/>
		</property> 
	</bean>

	<bean id="GerenciaEmpresaViaria" class="lps.bet.basico.web.controlGerencia.viacao.GerenciaEmpresaViaria">
		<property name="interfaceViacaoMgt">
			<ref bean="ViacaoMgr"/>
		</property>
	</bean>

	<bean id="GerenciaSistViarioUrbano" class="lps.bet.basico.web.controlGerencia.viacao.GerenciaSistViarioUrbano">
		<property name="interfaceViacaoMgt">
		<ref bean="ViacaoMgr"/>
		</property> 
	</bean>

	<bean id="GerenciaFuncionario" class="lps.bet.basico.web.controlGerencia.funcionario.GerenciaFuncionario">
		<property name="interfaceFuncionarioMgt">
			<ref bean="FuncionarioMgr"/>
		</property> 
		<property name="interfaceViacaoMgt">
			<ref bean="ViacaoMgr"/>
		</property> 
	</bean>

	<bean id="GerenciaCargo" class="lps.bet.basico.web.controlGerencia.funcionario.GerenciaCargo">
		<property name="interfaceFuncionarioMgt">
			<ref bean="FuncionarioMgr"/>
		</property>
	</bean>
	
	<bean id="GerenciaLinha" class="lps.bet.basico.web.controlGerencia.linha.GerenciaLinha">
		<property name="interfaceLinhaMgt">
			<ref bean="LinhaMgr"/>
		</property> 
		<property name="interfaceViacaoMgt">
			<ref bean="ViacaoMgr"/>
		</property> 
	</bean>

	<bean id="GerenciaOnibus" class="lps.bet.basico.web.controlGerencia.linha.GerenciaOnibus">
		<property name="interfaceLinhaMgt">
			<ref bean="LinhaMgr"/>
		</property> 
	</bean>
	
	<bean id="GerenciaCorrida" class="lps.bet.basico.web.controlGerencia.linha.GerenciaCorrida">
		<property name="interfaceLinhaMgt">
			<ref bean="LinhaMgr"/>
		</property>
	</bean>
	
	<bean id="GerenciaPassageiro" class="lps.bet.basico.web.controlGerencia.passageiro.GerenciaPassageiro">
		<property name="interfacePassageiroMgt">
			<ref bean="PassageiroMgr"/>
		</property> 
		<property name="nivelMinimoAcesso">
			<value>${config.nivel.GerenciaPassageiro}</value>
		</property>
	</bean>
	
	<bean id="GerenciaTipoPassageiro" class="lps.bet.basico.web.controlGerencia.cartao.GerenciaTipoPassageiro">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
	</bean>
	
	<bean id="GerenciaCartao" class="lps.bet.basico.web.controlGerencia.cartao.GerenciaCartao">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfacePassageiroMgt">
			<ref bean="PassageiroMgr"/>
		</property> 
		<property name="nivelMinimoAcesso">
			<value>${config.nivel.GerenciaCartao}</value>
		</property>
	</bean>	

	<bean id="GerenciaPagamento" class="lps.bet.basico.web.controlGerencia.cartao.GerenciaPagamento">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
	</bean>
	
	<bean id="GerenciaViagem" class="lps.bet.basico.web.controlGerencia.cartao.GerenciaViagem">
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfaceLinhaMgt">
			<ref bean="LinhaMgr"/>
		</property> 
	</bean>
	
  	<!--COPIEI DO BETSERVIDOR-CONTEXT tudo que tem aqui embaixo-->
	
	<bean id="ControlValidadorServidor" class="lps.bet.basico.controlValidadorServidor.ControlValidadorServidor">
		<property name="interfaceRegistrarCorrida">
			<ref bean="ControlarCorrida"/>
		</property> 
		<property name="interfaceProcessarViagem">
			<ref bean="ControlarViagem"/>
		</property> 
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
	</bean>

	<bean id="ControlarCorrida" class="lps.bet.basico.controlarCorrida.ControlarCorrida">
		<property name="interfaceAtualizarCorrida">
			<ref bean="LinhaMgr"/>
		</property> 
	</bean>

	<bean id="ControlarViagem" class="lps.bet.basico.controlarViagem.ControlarViagem">
		<property name="interfaceRegistrarViagem">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfaceCartaoMgt">
			<ref bean="CartaoMgr"/>
		</property> 
		<property name="interfaceRegistrarArrecadacao">
			<ref bean="LinhaMgr"/>
		</property> 
		<property name="interfaceLinhaMgt">
			<ref bean="LinhaMgr"/>
		</property> 
		<property name="interfaceViacaoMgt">
			<ref bean="ViacaoMgr"/>
		</property> 
	</bean>

	<!--bean id="CargaCartao" class="lps.bet.basico.web.cargaCartao.CargaCartao">
		<property name="interfaceCartaoMgt" ref="CartaoMgr"/>
	</bean-->
	
	<bean id="CartaoMgr" class="lps.bet.basico.cartaoMgr.CartaoMgr">
		<property name="viagemDAO">
			<ref bean="ViagemDAO"/>
		</property> 
		<property name="cartaoDAO">
			<ref bean="CartaoDAO"/>
		</property> 
		<property name="tipoPassageiroDAO">
			<ref bean="TipoPassageiroDAO"/>
		</property> 
		<property name="pagamentoDAO">
			<ref bean="PagamentoDAO"/>
		</property> 
		<property name="interfacePassageiroMgt">
			<ref bean="PassageiroMgr"/>
		</property> 
	</bean>

	<bean id="LinhaMgr" class="lps.bet.basico.linhaMgr.LinhaMgr">
		<property name="linhaDAO">
			<ref bean="LinhaDAO"/>
		</property> 
		<property name="corridaDAO">
			<ref bean="CorridaDAO"/>
		</property> 
		<property name="onibusDAO">
			<ref bean="OnibusDAO"/>
		</property> 
	</bean>

	<!-- Como PassageiroMgr eh implementado pelo DAO, ele ja foi colocado diretamente na parte dos DAOs-->
	
	<bean id="ViacaoMgr" class="lps.bet.basico.viacaoMgr.ViacaoMgr">
		<property name="empresaViariaDAO">
			<ref bean="EmpresaViariaDAO"/>
		</property> 
		<property name="sistViarioUrbanoDAO">
			<ref bean="SistViarioUrbanoDAO"/>
		</property> 
		<property name="tarifaDAO">
			<ref bean="TarifaDAO"/>
		</property> 
	</bean>

	<bean id="FuncionarioMgr" class="lps.bet.basico.funcionarioMgr.FuncionarioMgr">
		<property name="funcionarioDAO">
			<ref bean="FuncionarioDAO"/>
		</property> 
		<property name="cargoDAO">
			<ref bean="CargoDAO"/>
		</property> 
	</bean>
		
	<!--Beans de Aspectos do sistema BET-->

	<bean id="AutenticacaoAspecto" class="lps.bet.basico.web.autenticacao.Autenticacao" factory-method="aspectOf">
		<property name="autenticacaoDAO">
			<ref bean="AutenticacaoDAO"/>
		</property>
	</bean>
	
	<!-- Beans relacionados ao Hibernate: dataSource e sessionFactory -->
	
	<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
		<property name="url">
		 	<value>${config.db.url}</value>
		</property> 
		<property name="username">
		 	<value>${config.db.username}</value>
		</property> 
		<property name="password"> 
			<value>${config.db.password}</value>
		</property> 
		<property name="driverClassName">
			<value>org.postgresql.Driver</value>
		</property> 
	</bean>
	
	<bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">
	  <property name="dataSource">
		<ref bean="dataSource"/>
	  </property> 
	  <property name="mappingDirectoryLocations">
			<list>
				<value>${config.hibernate.location1}</value>
			</list>
	  </property>
	  <property name="hibernateProperties">
	    <props>
	      <prop key="hibernate.dialect">${config.hibernate.dialect}</prop>
	    </props>
	  </property>
	</bean>
			
	
	<!-- DAOs do Servidor do sistema BET -->
	
	<bean id="AutenticacaoDAO" class="lps.bet.basico.web.autenticacao.AutenticacaoDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property>
	</bean>

	
	<bean id="LinhaDAO" class="lps.bet.basico.linhaMgr.LinhaDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarLinhaCorrida">
			<value>${config.hql.BuscarLinhaCorrida}</value>
		</property>
		<property name="hqlBuscarLinhaPorNome">
			<value>${config.hql.BuscarLinhaPorNome}</value>
		</property>
	</bean>
	
	<bean id="CorridaDAO" class="lps.bet.basico.linhaMgr.CorridaDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarCorridasPrevistas">
			<value>${config.hql.BuscarCorridasPrevistas}</value>
		</property>
		<property name="hqlBuscarCorridaAtualOnibus">
			<value>${config.hql.BuscarCorridaAtualOnibus}</value>
		</property>
	</bean>
	
	<bean id="OnibusDAO" class="lps.bet.basico.linhaMgr.OnibusDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>
	
	<bean id="ViagemDAO" class="lps.bet.basico.cartaoMgr.ViagemDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarViagensPorCartao">
			<value>${config.hql.BuscarViagensPorCartao}</value>
		</property>
	</bean>
	
	<bean id="CartaoDAO" class="lps.bet.basico.cartaoMgr.CartaoDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>
	
	<bean id="TipoPassageiroDAO" class="lps.bet.basico.cartaoMgr.TipoPassageiroDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarTipoPassagPorCartao">
			<value>${config.hql.BuscarTipoPassagPorCartao}</value>
		</property>
		<property name="hqlBuscarTipoPorNome">
			<value>${config.hql.BuscarTipoPorNome}</value>
		</property>
	</bean>
	
	<bean id="PagamentoDAO" class="lps.bet.basico.cartaoMgr.PagamentoDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>
	
    <bean id="TarifaDAO" class="lps.bet.basico.viacaoMgr.TarifaDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarTarifasOrdenadas">
			<value>${config.hql.BuscarTarifasOrdenadas}</value>
		</property>
	</bean>
	
	<bean id="EmpresaViariaDAO" class="lps.bet.basico.viacaoMgr.EmpresaViariaDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>
	
	<bean id="SistViarioUrbanoDAO" class="lps.bet.basico.viacaoMgr.SistViarioUrbanoDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>

	<bean id="FuncionarioDAO" class="lps.bet.basico.funcionarioMgr.FuncionarioDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
	</bean>	

	<bean id="CargoDAO" class="lps.bet.basico.funcionarioMgr.CargoDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarCargoPorNome">
			<value>${config.hql.BuscarCargoPorNome}</value>
		</property>
	</bean>	
	
	<bean id="PassageiroMgr" class="lps.bet.basico.passageiroMgr.PassageiroDAO">
		<property name="sessionFactory">
			<ref bean="sessionFactory"/>
		</property> 
		<property name="hqlBuscarPassageiroPorCPF">
			<value>${config.hql.BuscarPassageiroPorCPF}</value>
		</property>
		<property name="hqlBuscarPassageiroPorNome">
			<value>${config.hql.BuscarPassageiroPorNome}</value>
		</property>
	</bean>

	
</beans>